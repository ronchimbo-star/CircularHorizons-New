---
import Layout from '../layouts/Layout.astro';
import { supabase } from '../lib/supabase';

export const prerender = false;

const { slug } = Astro.params;

const { data: page } = await supabase
  .from('pages')
  .select('*')
  .eq('slug', slug)
  .eq('is_published', true)
  .single();

if (!page) {
  return Astro.redirect('/404');
}
---

<Layout
  title={page.meta_title || page.title}
  description={page.meta_description}
>
  <div class="bg-white">
    <div class="max-w-4xl mx-auto py-16 px-4 sm:px-6 lg:px-8">
      <article class="prose prose-lg max-w-none">
        <Fragment set:html={page.content} />
      </article>
    </div>
  </div>
</Layout>
